import"./objectWithoutProperties-be1375b5.js";import"./slicedToArray-1bde1c63.js";import"./defineProperty-0a7db1e6.js";import e from"react";import{Button as t}from"@patternfly/react-core/dist/esm/components/Button/Button.js";import n from"prop-types";import{useIntl as a,FormattedMessage as r}from"react-intl";import"@data-driven-forms/react-form-renderer/dist/cjs/component-types";import"@data-driven-forms/react-form-renderer/dist/cjs/validator-types";import{_ as o}from"./toConsumableArray-6a92248c.js";import{TextContent as i}from"@patternfly/react-core/dist/esm/components/Text/TextContent.js";import{TextListItem as s,TextListItemVariants as c}from"@patternfly/react-core/dist/esm/components/Text/TextListItem.js";import{TextList as m,TextListVariants as p}from"@patternfly/react-core/dist/esm/components/Text/TextList.js";import{Alert as d}from"@patternfly/react-core/dist/esm/components/Alert/Alert.js";import l from"lodash/get";import"@patternfly/react-core/dist/esm/components/Form/FormHelperText.js";import"@patternfly/react-icons/dist/esm/icons/question-circle-icon";import{Popover as u}from"@patternfly/react-core/dist/esm/components/Popover/Popover.js";import"@patternfly/react-core/dist/esm/components/Text/Text.js";import{h as f}from"./hardcodedSchemas-1df4e8df.js";import"@patternfly/react-core/dist/esm/components/ClipboardCopy/ClipboardCopy.js";import y from"@data-driven-forms/react-form-renderer/dist/cjs/use-form-api";import"@redhat-cloud-services/frontend-components-utilities/files/cjs/interceptors";import{COST_MANAGEMENT_APP_NAME as h}from"./constants.js";import"./index-713c67d9.js";import{b as g,g as v,k as b,l as j}from"./schemaBuilder-f76a5124.js";var M=function ValuePopover(n){var r=n.label,o=n.value,i=a();return e.createElement(u,{headerContent:r,bodyContent:o,position:"top",maxWidth:"80%"},e.createElement(t,{variant:"link",isInline:!0,className:"ins-c-sources__wizard--summary-buttonss"},i.formatMessage({id:"wizard.showMore",defaultMessage:"Show more"})))};M.propTypes={label:n.node,value:n.node};var E=function createItem(t,n,a){var o=l(n,t.name);if((!t.stepKey||a.includes(t.stepKey))&&!(t.condition&&l(n,t.condition.when)!==t.condition.is||t.hideField))return o&&"password"===t.type&&(o="●●●●●●●●●●●●"),"boolean"==typeof o&&(o=o?e.createElement(r,{id:"wizard.yes",defaultMessage:"Yes"}):e.createElement(r,{id:"wizard.no",defaultMessage:"No"})),!o&&"authentication.password"===t.name&&l(n,"authentication.id")&&(o="●●●●●●●●●●●●"),{label:t["aria-label"]||t.label,value:o||"-"}},T=function getAllFieldsValues(e,t,n){return e.map((function(e){return E(e,t,n)})).filter(Boolean)},w=function getStepKeys(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic",a=arguments.length>3?arguments[3]:void 0;return[].concat(o(l(f,[e,"authentication",t,n,"includeStepKeyFields"],[])),o(l(f,[e,"authentication",t,n,"additionalSteps"],[]).map((function(e){return e.name}))),["".concat(e,"-").concat(t,"-").concat(n,"-additional-step"),"".concat(e,"-").concat(t,"-additional-step"),a?"".concat(e,"-").concat(a):void 0]).filter(Boolean)},A=function SourceWizardSummary(t){var n,r=t.sourceTypes,u=t.applicationTypes,E=t.showApp,A=t.showAuthType,x=y(),_=a(),S=x.getState().values,z=r.find((function(e){return e.name===S.source_type||e.id===S.source.source_type_id})),q=S.authentication&&S.authentication.authtype?S.authentication.authtype:S.auth_select,C=[];q&&(n=z.schema.authentication.find((function(e){return e.type===q})),C=n&&n.fields?n.fields:[]);var F=S.application?u.find((function(e){return e.id===S.application.application_type_id})):void 0,R=F||{},P=R.display_name,B=void 0===P?_.formatMessage({id:"wizard.notSelected",defaultMessage:"Not selected"}):P,K=R.name,W=R.id,k=g(z.name,q,K),I=z.schema.endpoint.fields;k&&(I=[],C=C.filter((function(e){return!e.name.includes("authentication.")})));var N=w(z.name,q,K,W),L=v(z.name,q,K),O=l(f,[z.name,"authentication",q,K,"customSteps"],!1);L.length>0&&(C=L.map((function(e){return[].concat(o(e.fields),o(C.filter((function(t){var n=t.stepKey;return n&&e.name===n}))))})).flatMap((function(e){return e})).filter((function(e){var t=e.name;return C.find((function(e){return e.name===t}))||O&&I.find((function(e){return e.name===t}))}))),O&&(I=[]),C=b(C,z.name,q,K||"generic"),I=j(I,z.name);var V=[].concat(o(C),o(I)),D=T(V,S,N).map((function(t){var n=t.label,a=t.value;return(e.createElement(e.Fragment,{key:"".concat(n,"--").concat(a)},e.createElement(s,{component:c.dt},n),e.createElement(s,{component:c.dd},a.toString().length>150?e.createElement(M,{label:n,value:a}):a)))}));return e.createElement(e.Fragment,null,e.createElement(i,null,e.createElement(m,{component:p.dl},e.createElement(s,{component:c.dt},_.formatMessage({id:"wizard.name",defaultMessage:"Name"})),e.createElement(s,{component:c.dd},S.source.name),E&&e.createElement(e.Fragment,null,e.createElement(s,{component:c.dt},_.formatMessage({id:"wizard.application",defaultMessage:"Application"})),e.createElement(s,{component:c.dd},B)),e.createElement(s,{component:c.dt},_.formatMessage({id:"wizard.sourceType",defaultMessage:"Source type"})),e.createElement(s,{component:c.dd},z.product_name),!k&&n&&A&&e.createElement(e.Fragment,null,e.createElement(s,{component:c.dt},_.formatMessage({id:"wizard.authenticationType",defaultMessage:"Authentication type"})),e.createElement(s,{component:c.dd},n.name)),D)),K===h&&e.createElement(d,{variant:"info",isInline:!0,title:_.formatMessage({id:"cost.rbacWarningTitle",defaultMessage:"Manage permissions in User Access"})},_.formatMessage({id:"cost.rbacWarningDescription",defaultMessage:"Make sure to manage permissions for this source in custom roles that contain permissions for Cost Management."})))};A.propTypes={sourceTypes:n.arrayOf(n.shape({id:n.string.isRequired,name:n.string.isRequired,product_name:n.string.isRequired,schema:n.shape({authentication:n.array,endpoint:n.object})})).isRequired,applicationTypes:n.arrayOf(n.shape({id:n.string.isRequired,name:n.string.isRequired,display_name:n.string.isRequired})).isRequired,showApp:n.bool,showAuthType:n.bool},A.defaultProps={showApp:!0,showAuthType:!0};export default A;export{E as createItem,T as getAllFieldsValues,w as getStepKeys};

import{_ as e}from"./slicedToArray-1bde1c63.js";import{_ as t}from"./defineProperty-0a7db1e6.js";import a,{useState as n,useEffect as o}from"react";import{useIntl as s,FormattedMessage as r}from"react-intl";import i from"@data-driven-forms/react-form-renderer/dist/cjs/component-types";import c from"@data-driven-forms/react-form-renderer/dist/cjs/validator-types";import{TextContent as l}from"@patternfly/react-core/dist/esm/components/Text/TextContent.js";import{TextListItem as d,TextListItemVariants as m}from"@patternfly/react-core/dist/esm/components/Text/TextListItem.js";import{TextList as u,TextListVariants as p}from"@patternfly/react-core/dist/esm/components/Text/TextList.js";import{FormHelperText as f}from"@patternfly/react-core/dist/esm/components/Form/FormHelperText.js";import g from"@patternfly/react-icons/dist/esm/icons/question-circle-icon";import{Popover as E}from"@patternfly/react-core/dist/esm/components/Popover/Popover.js";import{Text as h,TextVariants as M}from"@patternfly/react-core/dist/esm/components/Text/Text.js";import{ClipboardCopy as y,ClipboardCopyVariant as b}from"@patternfly/react-core/dist/esm/components/ClipboardCopy/ClipboardCopy.js";import _ from"@data-driven-forms/react-form-renderer/dist/cjs/use-form-api";import{COST_MANAGEMENT_APP_NAME as w,CLOUD_METER_APP_NAME as A,CATALOG_APP as T}from"./constants.js";import{a as I}from"./index-713c67d9.js";var R=function SSLFormLabel(){var e=s();return(a.createElement(a.Fragment,null,e.formatMessage({id:"wizard.sslCertificate",defaultMessage:"SSL Certificate"}),a.createElement(E,{"aria-label":"Help text",maxWidth:"50%",bodyContent:a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"wizard.openshiftCADescription1",defaultMessage:"You can obtain your OpenShift Container Platform providerâ€™s CA certificate for all endpoints (default, metrics, alerts) from {cmd}."},{cmd:a.createElement("b",{key:"b"},"/etc/origin/master/ca.crt")})),a.createElement(h,{component:M.p},e.formatMessage({id:"wizard.openshiftCADescription2",defaultMessage:"Paste the output (a block of text starting with --BEGIN CERTIFICATE--) into the Trusted CA Certificates field."})))},a.createElement(g,{className:"pf-u-ml-sm"}))))},S=a.createElement(r,{id:"wizard.wizardDescription",defaultMessage:"Connect a data source to use with your applications."}),D=a.createElement(r,{id:"wizard.wizardTitle",defaultMessage:"Add source"}),C="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.5",z="".concat(C,"/html/getting_started_with_cost_management/assembly_adding_sources_cost#creating_an_aws_s3_bucket"),k="".concat(C,"/html/getting_started_with_cost_management/assembly_adding_sources_cost#enabling_aws_account_access"),v="".concat(C,"/html/getting_started_with_cost_management/assembly_adding_sources_cost#installing_ocp_prerequisites"),F="".concat(C,"/html/getting_started_with_cost_management/assembly_adding_sources_cost#creating_an_azure_storage_account"),L="".concat(C,"/html/getting_started_with_cost_management/assembly_adding_sources_cost#configuring_an_azure_service_principal"),x="".concat(C,"/html/getting_started_with_cost_management/assembly_adding_sources_cost#configuring_an_azure_daily_export_schedule"),P=function AllFieldAreRequired(){var e=s();return(a.createElement(h,{component:M.p,className:"ins-c-sources__wizard--all-required-text"},e.formatMessage({id:"catalog.auth.allFieldsRequired",defaultMessage:"All fields are required."})))},N=a.createElement(r,{id:"wizard.arnPattern",defaultMessage:"ARN must start with arn:aws:"}),O=a.createElement(r,{id:"wizard.arnLength",defaultMessage:"ARN should have at least 10 characters"}),X={placeholder:"arn:aws:iam:123456789:role/CostManagement",isRequired:!0,validate:[{type:c.REQUIRED},{type:c.PATTERN,pattern:/^arn:aws:.*/,message:N},{type:c.MIN_LENGTH,threshold:10,message:O}]},U={placeholder:"arn:aws:iam:123456789:role/SubscriptionWatch",isRequired:!0,validate:[{type:c.REQUIRED},{type:c.PATTERN,pattern:/^arn:aws:.*/,message:N},{type:c.MIN_LENGTH,threshold:10,message:O}],label:a.createElement(r,{id:"wizard.arn",defaultMessage:"ARN"})},q={isRequired:!0,validate:[{type:c.REQUIRED},{type:c.PATTERN,message:a.createElement(r,{id:"catalog.urlPatternMessage",defaultMessage:"URL must start with https:// or http://"}),pattern:/^https{0,1}:\/\//},{type:c.URL}],helperText:a.createElement(f,{isHidden:!1},a.createElement(r,{id:"catalog.hostnameHelper",defaultMessage:"For example, https://myansibleinstance.example.com/ or https://127.0.0.1/"})),label:a.createElement(r,{id:"wizard.hostname",defaultMessage:"Hostname"})},W={openshift:{authentication:{token:t({generic:{"authentication.password":{isRequired:!0,validate:[{type:c.REQUIRED}]},additionalFields:[{component:"description",name:"description-summary",Content:function DescriptionSummary(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"openshift.token.description",defaultMessage:"An OpenShift Container Platform login token is required to communicate with the application."})),a.createElement(h,{component:M.p},e.formatMessage({id:"openshift.token.collectData",defaultMessage:"To collect data from a Red Hat OpenShift Container Platform source:"})),a.createElement(u,{component:"ol"},a.createElement(d,{component:"li"},e.formatMessage({id:"openshift.token.logIn",defaultMessage:"Log in to the Red Hat OpenShift Container Platform cluster with an account that has access to the namespace"})),a.createElement(d,{component:"li"},e.formatMessage({id:"openshift.token.runCommand",defaultMessage:"Run the following command to obtain your login token:"})),a.createElement(y,{className:"pf-u-mb-md",isReadOnly:!0},e.formatMessage({id:"openshift.token.comman",defaultMessage:"# oc sa get-token -n management-infra management-admin"})),a.createElement(d,{component:"li"},e.formatMessage({id:"openshift.token.copyToken",defaultMessage:"Copy the token and paste it in the Token field"})))))}}]}},w,{skipSelection:!0,skipEndpoint:!0,"source.source_ref":{label:a.createElement(r,{id:"wizard.clusterId",defaultMessage:"Cluster Identifier"}),isRequired:!0,component:i.TEXT_FIELD,validate:[{type:c.REQUIRED},{type:c.PATTERN,pattern:/^[A-Za-z0-9]+[A-Za-z0-9_-]*$/,message:a.createElement(r,{id:"wizard.clusterIdPattern",defaultMessage:"Cluster ID must start with alphanumeric character and can contain underscore and hyphen"})}]},additionalSteps:[{title:a.createElement(r,{id:"cost.configureOperator",defaultMessage:"Cost Management Operator"}),fields:[{component:"description",name:"description-summary",Content:function ConfigureCostOperator(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.openshift.description",defaultMessage:"The Cost Management Operator collects the data required for Cost Management. This is supported for clusters that are OpenShift Container Platform version 4.3 or later. {more}"},{more:a.createElement(h,{key:"link",component:M.a,href:v,target:"_blank",rel:"noopener noreferrer"},e.formatMessage({id:"wizard.learnMore",defaultMessage:"Learn more"}))})),a.createElement(l,{className:"list-align-left"},a.createElement(u,{component:"ol"},a.createElement(d,{component:"li"},e.formatMessage({id:"cost.openshift.installOperator",defaultMessage:"Install the Cost Management Operator from OperatorHub on your cluster (search for {cost})."},{cost:a.createElement("i",{key:"italic"},e.formatMessage({id:"cost.costManagement",defaultMessage:"cost management"}))})),a.createElement(d,{component:"li"},e.formatMessage({id:"cost.openshift.aboutScreen",defaultMessage:"When configuration is complete, enter the cluster identifier below. The cluster identifier can be found in the cluster's Help > About screen."}))))))}},{name:"source.source_ref"},{component:i.TEXT_FIELD,name:"authentication.authtype",hideField:!0,initialValue:"token",initializeOnMount:!0}]}]})},endpoint:{url:{placeholder:"https://myopenshiftcluster.mycompany.com",isRequired:!0,validate:[{type:c.REQUIRED},{type:c.URL,message:a.createElement(r,{id:"wizard.urlPatternMessage",defaultMessage:"The URL is not formatted correctly."})}]},"endpoint.certificate_authority":{label:a.createElement(R,null),"aria-label":"SSL Certificate"},additionalFields:[{component:"description",name:"description-summary",Content:function EndpointDesc(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"openshift.endpoint.urlAndCA",defaultMessage:"Provide the OpenShift Container Platform URL and SSL certificate."}))))}}]}},azure:{authentication:{tenant_id_client_id_client_secret:t({},w,{useApplicationAuth:!0,skipSelection:!0,"credentials.subscription_id":{placeholder:"",validate:[{type:c.REQUIRED},{type:c.PATTERN,pattern:/^[A-Za-z0-9]+[A-Za-z0-9_-]*$/,message:a.createElement(r,{id:"cost.subidPattern",defaultMessage:"Subscription ID must start with alphanumeric character and can contain underscore and hyphen"})}],isRequired:!0},"billing_source.data_source.resource_group":{placeholder:"",validate:[{type:c.REQUIRED},{type:c.PATTERN,pattern:/^[A-Za-z0-9]+[A-Za-z0-9_-]*$/,message:a.createElement(r,{id:"cost.resourceGroupPattern",defaultMessage:"Resource group must start with alphanumeric character and can contain underscore and hyphen"})}]},"billing_source.data_source.storage_account":{placeholder:"",validate:[{type:c.REQUIRED},{type:c.PATTERN,pattern:/^[A-Za-z0-9]+[A-Za-z0-9_-]*$/,message:a.createElement(r,{id:"cost.storageAccountPattern",defaultMessage:"Storage account must start with alphanumeric character and can contain underscore and hyphen"})}]},"authentication.password":{type:"password",validate:[{type:c.REQUIRED}],label:a.createElement(r,{id:"cost.clientSecret",defaultMessage:"Client secret"})},"authentication.username":{validate:[{type:c.REQUIRED}],label:a.createElement(r,{id:"cost.clientAppId",defaultMessage:"Client (Application) ID"})},"authentication.extra.azure.tenant_id":{label:a.createElement(r,{id:"cost.tenantDirId",defaultMessage:"Tenant (Directory) ID"}),validate:[{type:c.REQUIRED}]},additionalSteps:[{title:a.createElement(r,{id:"cost.azureSubStepId",defaultMessage:"Resource group and storage account"}),nextStep:"azure-sub-id",fields:[{component:i.TEXT_FIELD,name:"authentication.authtype",hideField:!0,initialValue:"tenant_id_client_id_client_secret",initializeOnMount:!0},{name:"azure-storage-account-description",component:"description",Content:function ConfigureResourceGroupAndStorageAccount(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.azure.storageAccountDescription",defaultMessage:"Red Hat recommends creating a dedicated resource group and storage account in Azure to collect cost data and metrics for cost management. {link}"},{link:a.createElement(h,{key:"link",rel:"noopener noreferrer",target:"_blank",component:M.a,href:F},e.formatMessage({id:"wizard.learnMore defaultMessage=Learn more",defaultMessage:"Learn more"}))})),a.createElement(h,{component:M.p},e.formatMessage({id:"cost.azure.storageAccountAfterDescription",defaultMessage:"After configuring a resource group and storage account in the Azure portal, enter the following:"}))))}},{name:"all-required",component:"description",Content:P},{name:"billing_source.data_source.resource_group",component:i.TEXT_FIELD,label:a.createElement(r,{id:"wizard.resourceGroupName",defaultMessage:"Resource group name"})},{name:"billing_source.data_source.storage_account",component:i.TEXT_FIELD,label:a.createElement(r,{id:"wizard.storageAccountName",defaultMessage:"Storage account name"})}]},{title:a.createElement(r,{id:"wizard.subscriptionId",defaultMessage:"Subscription ID"}),name:"azure-sub-id",nextStep:"configure-roles",fields:[{name:"azure-sub-id-description",component:"description",Content:function SubscriptionID(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.azure.subscriptionIdCommand",defaultMessage:"Run the following command in Cloud Shell to obtain your Subscription ID and enter it below:"})),a.createElement(y,null,'az account show --query "{ subscription_id: id }"')))}},{name:"credentials.subscription_id",component:i.TEXT_FIELD,label:a.createElement(r,{id:"wizard.subscriptionId",defaultMessage:"Subscription ID"})}]},{title:a.createElement(r,{id:"wizard.configureRoles",defaultMessage:"Roles"}),name:"configure-roles",nextStep:"export-schedule",fields:[{name:"configure-service-principal",component:"description",Content:function ConfigureRolesDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.azure.dedicatedCredentials",defaultMessage:"Red Hat recommends configuring dedicated credentials to grant Cost Management read-only access to Azure cost data.  {link}"},{link:a.createElement(h,{key:"link",rel:"noopener noreferrer",target:"_blank",component:M.a,href:L},e.formatMessage({id:"wizard.learnMore defaultMessage=Learn more",defaultMessage:"Learn more"}))})),a.createElement(h,{component:M.p},e.formatMessage({id:"cost.azure.createContributorRole",defaultMessage:"Run the following command in Cloud Shell to create a Cost Management Storage Account Contributor role. From the output enter the values in the fields below:"})),a.createElement(y,null,'az ad sp create-for-rbac -n "CostManagement" --role "Storage Account Contributor" --query \'{"tenant": tenant, "client_id": appId, "secret": password}\'')))}},{name:"all-required",component:"description",Content:P},{name:"authentication.extra.azure.tenant_id",component:i.TEXT_FIELD},{name:"authentication.username",component:i.TEXT_FIELD},{name:"authentication.password",component:i.TEXT_FIELD},{name:"reader-role",component:"description",Content:function ReaderRoleDescription(){var e=_().getState().values.credentials,t=s();return a.createElement(l,null,a.createElement(h,{component:M.p},t.formatMessage({id:"cost.azure.createReaderRole",defaultMessage:"Run the following command in Cloud Shell to create a Cost Management Reader role:"})),a.createElement(y,null,'az role assignment create --role "Cost Management Reader" --assignee http://CostManagement --subscription '.concat(e.subscription_id)))}}]},{title:a.createElement(r,{id:"cost.createDailyExport",defaultMessage:"Daily export"}),name:"export-schedule",fields:[{name:"export-schedule-description",component:"description",Content:function ExportSchedule(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.azure.storageAccountDescription",defaultMessage:"Create a recurring task to export cost data to your Azure storage account, where cost management will retrieve the data.  {link}"},{link:a.createElement(h,{key:"link",rel:"noopener noreferrer",target:"_blank",component:M.a,href:x},e.formatMessage({id:"wizard.learnMore defaultMessage=Learn more",defaultMessage:"Learn more"}))})),a.createElement(l,{className:"list-align-left"},a.createElement(u,{component:p.ol},a.createElement(d,{component:m.li},e.formatMessage({id:"cost.azure.storageAccountDescription",defaultMessage:"From the Azure portal, add a new export."})),a.createElement(d,{component:m.li},e.formatMessage({id:"cost.azure.storageAccountDescription",defaultMessage:"Provide a name for the container and directory path, and specify the below settings to create the daily export. Leave all other options as the default."})))),a.createElement(u,{className:"export-table",component:p.dl},a.createElement(d,{component:m.dt},a.createElement(h,{component:M.b},e.formatMessage({id:"cost.azure.exportType",defaultMessage:"Export type"}))),a.createElement(d,{component:m.dd},e.formatMessage({id:"cost.azure.dailyExport",defaultMessage:"Daily export for billing-period-to-date costs"})),a.createElement(d,{component:m.dt},a.createElement(h,{component:M.b},e.formatMessage({id:"cost.azure.storageAccountName",defaultMessage:"Storage account name"}))),a.createElement(d,{component:m.dd},e.formatMessage({id:"cost.azure.createdAccountName",defaultMessage:"Storage account name created earlier"})))))}}]}]})}},amazon:{authentication:{access_key_secret_key:{generic:{"authentication.username":{label:a.createElement(r,{id:"wizard.accessKeyId",defaultMessage:"Access key ID"}),placeholder:"AKIAIOSFODNN7EXAMPLE",isRequired:!0,validate:[{type:c.REQUIRED}]},"authentication.password":{label:a.createElement(r,{id:"wizard.secretAccessKey",defaultMessage:"Secret access key"}),placeholder:"wJairXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",isRequired:!0,validate:[{type:c.REQUIRED}],type:"password"},skipSelection:!0,onlyHiddenFields:!0,additionalSteps:[{title:a.createElement(r,{id:"wizard.configureAccountAccess",defaultMessage:"Account access"}),fields:[{component:"description",name:"description-summary",Content:function DescriptionSummary(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"wizard.createAccesKeyPart1",defaultMessage:"Create an access key in your AWS user account and enter the details below."})),a.createElement(h,{component:M.p},e.formatMessage({id:"wizard.createAccesKeyPart2",defaultMessage:"For sufficient access and security, Red Hat recommends using the Power user identity and access management (IAM) policy for your AWS user account. "}),a.createElement(E,{"aria-label":"Help text",position:"bottom",bodyContent:a.createElement(a.Fragment,null,a.createElement(h,{component:M.p},e.formatMessage({id:"wizard.createAccesKeyHelpText",defaultMessage:"The Power user policy allows the user full access to API functionality and AWS services for user administration. Create an access key in the Security Credentials area of your AWS user account. When adding your AWS account as a source, the access key ID and secret access key act as your user ID and password."})))},a.createElement(g,null)))))}},{name:"authentication.username",component:i.TEXT_FIELD},{name:"authentication.password",component:i.TEXT_FIELD},{component:i.TEXT_FIELD,name:"authentication.authtype",hideField:!0,initialValue:"access_key_secret_key",initializeOnMount:!0}]}]}},arn:t({generic:{includeStepKeyFields:["arn"],"authentication.password":X}},w,{useApplicationAuth:!0,skipSelection:!0,"authentication.password":X,"billing_source.data_source.bucket":{placeholder:"cost-usage-bucket",validate:[{type:c.REQUIRED},{type:c.PATTERN,pattern:/^[A-Za-z0-9]+[A-Za-z0-9_-]*$/,message:a.createElement(r,{id:"cost.arn.s3BucketPattern",defaultMessage:"S3 bucket name must start with alphanumeric character and can contain underscore and hyphen"})}],isRequired:!0},additionalSteps:[{title:a.createElement(r,{id:"cost.arn.usageDescriptionTitle",defaultMessage:"Cost and usage reporting"}),nextStep:"tags",fields:[{name:"usage-description",component:"description",Content:function UsageDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.usageDescription.usageDescription",defaultMessage:"To collect and store the information needed for cost management, you need to set up an Amazon S3 bucket for cost and usage reports. {link}"},{link:a.createElement(h,{key:"link",component:M.a,href:z,rel:"noopener noreferrer",target:"_blank"},e.formatMessage({id:"cost.learnMore",defaultMessage:"Learn more"}))})),a.createElement(u,{component:p.ol},a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.specifyBucker",defaultMessage:"Specify or create an Amazon S3 bucket for your account."})),a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.addFollowingValues",defaultMessage:"Create a cost and usage report using the following values:"}),a.createElement(u,null,a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.repornName",defaultMessage:"Report name: koku"})),a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.timeUnitHoulry",defaultMessage:"Time unit: hourly"})),a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.includesResourceIDs",defaultMessage:"Include: Resource IDs"})),a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.enableSuppor",defaultMessage:"Enable support for: RedShift, QuickSight and disable support for Athena"})),a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.reportPathPrefix",defaultMessage:"Report path prefix: (leave blank)"})),a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.compression",defaultMessage:"Compression type: GZIP"})))),a.createElement(d,null,e.formatMessage({id:"cost.usageDescription.enterNameOfCreatedBucker",defaultMessage:"Enter the name of the Amazon S3 bucket you just created below:"})))))}},{name:"billing_source.data_source.bucket",component:i.TEXT_FIELD,label:a.createElement(r,{id:"cost.arn.s3Label",defaultMessage:"S3 bucket name"})},{component:i.TEXT_FIELD,name:"authentication.authtype",hideField:!0,initialValue:"arn",initializeOnMount:!0}]},{title:a.createElement(r,{id:"cost.arn.tagsStepTitle",defaultMessage:"Activate cost allocation tags"}),name:"tags",nextStep:"iam-policy",fields:[{name:"tags-description",component:"description",Content:function TagsDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.tags.desciption",defaultMessage:"To use tags to organize your AWS resources in the cost management application, activate your tags in AWS to allow them to be imported automatically."})),a.createElement(u,{component:p.ol},a.createElement(d,null,e.formatMessage({id:"cost.tags.openSection",defaultMessage:"In the AWS Billing and Cost Management console, open the Cost Allocation Tags section."})),a.createElement(d,null,e.formatMessage({id:"cost.tags.selectTags",defaultMessage:"Select the tags you want to use in the cost management application, and click Activate."})))))}}]},{title:a.createElement(r,{id:"cost.arn.iamPolicyTitle",defaultMessage:"Create IAM policy"}),name:"iam-policy",nextStep:"iam-role",substepOf:{name:"eaa",title:a.createElement(r,{id:"cost.arn.enableAccountAccess",defaultMessage:"Enable account access"})},fields:[{name:"iam-policy-description",component:"description",Content:function IAMPolicyDescription(){var e,t,n=_(),o=s(),r=null===(e=n.getState().values.billing_source)||void 0===e?void 0:null===(t=e.data_source)||void 0===t?void 0:t.bucket;return r?a.createElement(l,null,a.createElement(h,{component:M.p},o.formatMessage({id:"cost.iampolicy.grantPermissions",defaultMessage:"To grant permissions to the cost management report you just configured, create an AWS Identity and Access Management (IAM) policy. {link}"},{link:a.createElement(h,{key:"link",component:M.a,href:k,rel:"noopener noreferrer",target:"_blank"},o.formatMessage({id:"wizard.learnMore",defaultMessage:"Learn more"}))})),a.createElement(u,{component:p.ol},a.createElement(d,{component:m.li},o.formatMessage({id:"cost.iampolicy.signInIAMConsole",defaultMessage:"Sign in to the AWS Identity and Access Management (IAM) console."})),a.createElement(d,{component:m.li},o.formatMessage({id:"cost.iampolicy.createPolicy",defaultMessage:"Create a new policy, pasting the following content into the JSON text box."})),a.createElement(y,{isCode:!0,variant:b.expansion,className:"pf-u-m-sm-on-sm",isReadOnly:!0},JSON.stringify({Version:"2012-10-17",Statement:[{Sid:"VisualEditor0",Effect:"Allow",Action:["s3:Get*","s3:List*"],Resource:["arn:aws:s3:::".concat(r),"arn:aws:s3:::".concat(r,"/*")]},{Sid:"VisualEditor1",Effect:"Allow",Action:["s3:HeadBucket","cur:DescribeReportDefinitions"],Resource:"*"}]},null,2)),a.createElement(d,{component:m.li},o.formatMessage({id:"cost.iampolicy.completeProccess",defaultMessage:"Complete the process to create your new policy."}))),a.createElement(h,{component:M.p},o.formatMessage({id:"cost.iampolicy.logInIam",defaultMessage:"{bold} You will need to be logged in to the IAM console to complete the next step."},{bold:a.createElement("b",{key:"bold"},o.formatMessage({id:"cost.DoNotCloseYourBrowser",defaultMessage:"Do not close your browser."}))}))):a.createElement(h,{component:M.p},o.formatMessage({id:"cost.iampolicy.somethingWrong",defaultMessage:"Something went wrong, you are missing bucket value."}))}}]},{title:a.createElement(r,{id:"cost.arn.iamRoleStepTitle",defaultMessage:"Create IAM role"}),name:"iam-role",nextStep:"arn",substepOf:"eaa",fields:[{name:"iam-role-description",component:"description",Content:function IAMRoleDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.iamrole.createIamRole",defaultMessage:"To delegate account access, create an IAM role to associate with your IAM policy."})),a.createElement(u,{component:p.ol},a.createElement(d,null,e.formatMessage({id:"cost.iamrole.createNewRole",defaultMessage:"From the AWS Identity access management console, create a new role."})),a.createElement(d,null,e.formatMessage({id:"cost.iamrole.enterAccountId",defaultMessage:"Select another AWS account from the list of trusted entities and paste the following value into the Account ID field:"})),a.createElement(y,{className:"pf-u-m-sm-on-sm",isReadOnly:!0},"589173575009"),a.createElement(d,null,e.formatMessage({id:"cost.iamrole.attachPolicy",defaultMessage:"Attach the permissions policy that you just created."})),a.createElement(d,null,e.formatMessage({id:"cost.iamrole.completeProccess",defaultMessage:"Complete the process to create your new role."})))))}}]},{title:a.createElement(r,{id:"cost.arn.enterArn",defaultMessage:"Enter ARN"}),name:"arn",substepOf:"eaa",fields:[{name:"arn-description",component:"description",Content:function ArnDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"cost.arn.enableAccess",defaultMessage:"To enable account access, capture the ARN associated with the role you just created."})),a.createElement(u,{component:p.ol},a.createElement(d,null,e.formatMessage({id:"cost.arn.selectRole",defaultMessage:"From the Roles tab, select the role you just created."})),a.createElement(d,null,e.formatMessage({id:"cost.arn.copyArn",defaultMessage:"From the Summary screen, copy the role ARN and paste it in the ARN field:"})))))}}]}]}),"cloud-meter-arn":t({generic:{includeStepKeyFields:["arn"],"authentication.password":U}},A,{useApplicationAuth:!0,skipSelection:!0,"authentication.password":U,additionalSteps:[{title:a.createElement(r,{id:"cloudmeter.createIamPolicy",defaultMessage:"Create IAM policy"}),nextStep:"subs-iam-role",substepOf:{name:"eaa",title:a.createElement(r,{id:"cloudmeter.enableAccountAccess",defaultMessage:"Enable account access"})},fields:[{name:"iam-policy-description",component:"description",Content:function IAMPolicyDescription(){var t=s(),r=n(),i=e(r,2),c=i[0],m=i[1];return o((function(){(function getSubWatchConfig(){return I.get("/api/cloudigrade/v2/sysconfig/")})().then((function(e){var t;return m(null==e?void 0:null===(t=e.aws_policies)||void 0===t?void 0:t.traditional_inspection)})).catch((function(e){console.error(e),m(t.formatMessage({id:"subwatch.iampolicy.subWatchConfigError",defaultMessage:"There is an error with loading of the configuration. Please go back and return to this step."}))}))}),[]),a.createElement(l,null,a.createElement(h,{component:M.p},t.formatMessage({id:"subwatch.iampolicy.grantPermissions",defaultMessage:"To grant permissions to obtain subscription data, create an AWS identity access management (IAM) policy."})),a.createElement(u,{component:p.ol},a.createElement(d,null,t.formatMessage({id:"subwatch.iampolicy.signIn",defaultMessage:"Sign in to the {link}."},{link:a.createElement("a",{key:"link",href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/console.html",rel:"noopener noreferrer",target:"_blank"},t.formatMessage({id:"subwatch.iampolicy.IAMconsole",defaultMessage:"AWS Identity Access Management* (IAM) console"}))})),a.createElement(d,null,t.formatMessage({id:"subwatch.iampolicy.createPolicty",defaultMessage:"Create a new policy, pasting the following content into the JSON text box."})),a.createElement(y,{isCode:!0,variant:b.expansion,className:"pf-u-m-sm-on-sm",isReadOnly:!0},c?JSON.stringify(c,null,2):t.formatMessage({id:"subwatch.iampolicy.loading",defaultMessage:"Loading configuration..."})),a.createElement(d,null,t.formatMessage({id:"subwatch.iampolicy.completeProcess",defaultMessage:"Complete the process to create your new policy."}))),a.createElement(h,{component:M.p},t.formatMessage({id:"subwatch.iampolicy.BDoNotCloseYourBrowserBYouWillNeedToBeLoggedInToTheIamConsoleToComputeTheNextStep",defaultMessage:"{bold} You will need to be logged in to the IAM console to compute the next step."},{bold:a.createElement("b",{key:"bold"},t.formatMessage({id:"subwatch.iampolicy.dontCloseBrowser",defaultMessage:"Do not close your browser."}))})))}},{component:i.TEXT_FIELD,name:"authentication.authtype",hideField:!0,initialValue:"cloud-meter-arn",initializeOnMount:!0}]},{title:a.createElement(r,{id:"cloudmeter.createIamRole",defaultMessage:"Create IAM role"}),name:"subs-iam-role",nextStep:"subs-arn",substepOf:"eaa",fields:[{name:"iam-role-description",component:"description",Content:function IAMRoleDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"subwatch.iamrole.delegateAccount",defaultMessage:"To delegate account access, create an IAM role to associate with your IAM policy."})),a.createElement(u,{component:p.ol},a.createElement(d,null,e.formatMessage({id:"subwatch.iamrole.createRole",defaultMessage:"From the AWS Identity access management console, create a new role."})),a.createElement(d,null,e.formatMessage({id:"subwatch.iamrole.pasteAccountID",defaultMessage:"Select another AWS account from the list of trusted entities and paste the following value into the Account ID field:"})),a.createElement(y,{className:"pf-u-m-sm-on-sm",isReadOnly:!0},"372779871274"),a.createElement(d,null,e.formatMessage({id:"subwatch.iamrole.attachPolicy",defaultMessage:"Attach the permissions policy that you just created."})),a.createElement(d,null,e.formatMessage({id:"subwatch.iamrole.completeProcess",defaultMessage:"Complete the process to create your new role."})))))}}]},{title:a.createElement(r,{id:"cloudmeter.enterArn",defaultMessage:"Enter ARN"}),name:"subs-arn",substepOf:"eaa",fields:[{name:"arn-description",component:"description",Content:function ArnDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p},e.formatMessage({id:"subwatch.arn.enableAccount",defaultMessage:"To enable account access, capture the ARN associated with the role you just created."})),a.createElement(u,{component:p.ol},a.createElement(d,null,e.formatMessage({id:"subwatch.arn.selectRole",defaultMessage:"From the Roles tab, select the role you just created."})),a.createElement(d,null,e.formatMessage({id:"subwatch.arn.copyArn",defaultMessage:"From the Summary screen, copy the role ARN and paste it in the ARN field:"})))))}},{component:i.TEXT_FIELD,name:"authentication.password"}]}]})},endpoint:{}},satellite:{endpoint:{},authentication:{receptor_node:{generic:{"source.source_ref":{label:a.createElement(r,{id:"satellite.satelliteId",defaultMessage:"Satellite ID"}),validate:[{type:c.REQUIRED}],component:i.TEXT_FIELD},"endpoint.receptor_node":{label:a.createElement(r,{id:"satellite.receptorId",defaultMessage:"Receptor ID"}),validate:[{type:c.REQUIRED}],component:i.TEXT_FIELD},skipSelection:!0,onlyHiddenFields:!0,customSteps:!0,additionalSteps:[{title:a.createElement(r,{id:"satellite.credentials",defaultMessage:"Credentials"}),nextStep:"summary",fields:[{name:"all-required",component:"description",Content:P},{name:"source.source_ref"},{name:"endpoint.receptor_node"},{component:i.TEXT_FIELD,name:"endpoint.role",hideField:!0,initializeOnMount:!0,initialValue:"satellite"},{component:i.TEXT_FIELD,name:"authentication.authtype",hideField:!0,initializeOnMount:!0,initialValue:"receptor_node"}]}]}}}},"ansible-tower":{authentication:{receptor_node:t({generic:{skipEndpoint:!0}},T,{skipEndpoint:!0}),username_password:t({generic:{skipSelection:!0,onlyHiddenFields:!0,customSteps:!0,"authentication.username":{isRequired:!1,validate:[{type:c.REQUIRED}],label:a.createElement(r,{id:"wizard.username",defaultMessage:"Username"})},"authentication.password":{type:"password",isRequired:!1,validate:[{type:c.REQUIRED}],label:a.createElement(r,{id:"wizard.password",defaultMessage:"Password"})},url:q,"endpoint.certificate_authority":{label:a.createElement(r,{id:"wizard.certificateAuthoriy",defaultMessage:"Certificate authority"})},"endpoint.verify_ssl":{initialValue:!1,label:a.createElement(r,{id:"wizard.verifySsl",defaultMessage:"Verify SSL"})},additionalSteps:[{title:a.createElement(r,{id:"wizard.credentials",defaultMessage:"Credentials"}),nextStep:"ansible-tower-credentials-no-app",fields:[{component:i.TEXT_FIELD,name:"authentication.authtype",hideField:!0,initialValue:"username_password",initializeOnMount:!0},{name:"required-desc",component:"description",Content:P},{component:i.TEXT_FIELD,name:"authentication.username"},{component:i.TEXT_FIELD,name:"authentication.password"}]},{name:"ansible-tower-credentials-no-app",title:a.createElement(r,{id:"catalog.ansibleTowerEndpoint",defaultMessage:"Ansible Tower endpoint"}),fields:[{name:"endpoint.role",component:i.TEXT_FIELD,hideField:!0,initialValue:"ansible",initializeOnMount:!0},{name:"url",component:i.TEXT_FIELD},{name:"endpoint.verify_ssl",component:i.SWITCH},{name:"endpoint.certificate_authority",component:i.TEXT_FIELD,condition:{is:!0,when:"endpoint.verify_ssl"}}]}]}},T,{skipSelection:!0,onlyHiddenFields:!0,customSteps:!0,"authentication.username":{isRequired:!1,validate:[{type:c.REQUIRED}],label:a.createElement(r,{id:"wizard.username",defaultMessage:"Username"})},"authentication.password":{type:"password",isRequired:!1,validate:[{type:c.REQUIRED}],label:a.createElement(r,{id:"wizard.password",defaultMessage:"Password"})},url:q,"endpoint.certificate_authority":{label:a.createElement(r,{id:"wizard.certificateAuthoriy",defaultMessage:"Certificate authority"})},"endpoint.verify_ssl":{initialValue:!1,label:a.createElement(r,{id:"wizard.verifySsl",defaultMessage:"Verify SSL"})},additionalSteps:[{nextStep:"catalog-ansible-tower",title:a.createElement(r,{id:"catalog.ansibleTowerEndpoint",defaultMessage:"Ansible Tower endpoint"}),fields:[{name:"ansible-tower-desc",component:"description",Content:function EndpointDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p,className:"pf-u-mb-l"},e.formatMessage({id:"catalog.endpoint.enterHostname",defaultMessage:"Enter the hostname of the Ansible Tower instance you want to connect to."}))))}},{name:"endpoint.role",component:i.TEXT_FIELD,hideField:!0,initialValue:"ansible",initializeOnMount:!0},{name:"url",component:i.TEXT_FIELD},{name:"endpoint.verify_ssl",component:i.SWITCH},{name:"endpoint.certificate_authority",component:i.TEXT_FIELD,condition:{is:!0,when:"endpoint.verify_ssl"}}]},{title:a.createElement(r,{id:"wizard.credentials",defaultMessage:"Credentials"}),name:"catalog-ansible-tower",fields:[{component:i.TEXT_FIELD,name:"authentication.authtype",hideField:!0,initialValue:"username_password",initializeOnMount:!0},{name:"required-desc",component:"description",Content:function AuthDescription(){var e=s();return(a.createElement(l,null,a.createElement(h,{component:M.p,className:"pf-u-mb-l"},e.formatMessage({id:"catalog.auth.provideTowerCredentials",defaultMessage:"Provide Ansible Tower service account user credentials to ensure optimized availability of resources to Catalog Administrators."})),a.createElement(P,null)))}},{component:i.TEXT_FIELD,name:"authentication.username"},{component:i.TEXT_FIELD,name:"authentication.password"}]}]})},endpoint:{url:q,"endpoint.certificate_authority":{label:a.createElement(r,{id:"wizard.certificateAuthority",defaultMessage:"Certificate authority"})},"endpoint.verify_ssl":{initialValue:!1}}}};export{D as W,S as a,W as h};

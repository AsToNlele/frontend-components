import{_ as e}from"./objectWithoutProperties-be1375b5.js";import{_ as t}from"./defineProperty-0a7db1e6.js";import n from"react";import{FormattedMessage as a}from"react-intl";import i from"@data-driven-forms/react-form-renderer/dist/cjs/component-types";import o from"@data-driven-forms/react-form-renderer/dist/cjs/validator-types";import{_ as r}from"./toConsumableArray-6a92248c.js";import c from"lodash/get";import{h as p}from"./hardcodedSchemas-1df4e8df.js";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(a),!0).forEach((function(n){t(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=function acronymMapper(e){return{"Amazon Web Services":"AWS"}[e]||e},s=function hardcodedSchema(e,t,n){return c(p,[e,"authentication",t,n],void 0)},u=function getAdditionalSteps(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"additionalSteps"],[])},l=function shouldSkipSelection(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"skipSelection"],!1)},m=function shouldSkipEndpoint(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"skipEndpoint"],!1)},f=function hasCustomSteps(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"customSteps"],!1)},h=function getAdditionalStepKeys(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"includeStepKeyFields"],[])},y=function getOnlyHiddenFields(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"onlyHiddenFields"],!1)},g=function getAdditionalStepFields(t,n){return t.filter((function(e){return e.stepKey===n})).map((function(t){t.stepKey;return e(t,["stepKey"])}))},S=function shouldUseAppAuth(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"useApplicationAuth"],!1)},v=function getNoStepsFields(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return!e.stepKey||t.includes(e.stepKey)}))},b=function injectAuthFieldsInfo(e,t,n,a){return e.map((function(e){var i=c(p,[t,"authentication",n,a]),o=i?c(i,e.name):c(p,[t,"authentication",n,"generic",e.name]),r=o?_objectSpread({},e,{},o):e;return"authentication.password"===r.name&&(r.component="authentication"),r}))},j=function injectEndpointFieldsInfo(e,t){return e.map((function(e){var n=c(p,[t,"endpoint",e.name]);return n?_objectSpread({},e,{},n):e}))},A=function getAdditionalAuthFields(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"additionalFields"],[])},_=function getAdditionalEndpointFields(e){return c(p,[e,"endpoint","additionalFields"],[])},E=function createEndpointStep(e,t){return _objectSpread({},e,{fields:[].concat(r(_(t)),r(j(e.fields,t))),name:"".concat(t,"-endpoint"),nextStep:"summary"})},F=function createAdditionalSteps(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"generic";return e.map((function(e){var c=e.name||"".concat(t,"-").concat(n,"-").concat(o,"-additional-step"),p=m(t,n,o),d=f(t,n,o);return _objectSpread({name:c,nextStep:!a||p||d?"summary":"".concat(t,"-endpoint")},e,{fields:[].concat(r(b(e.fields,t,n,o)),r(b(g(i,c),t,n,o)))})}))},O=function createGenericAuthTypeSelection(e,t,c){var p=e.schema.authentication,d=p.length>1,s=r(t),f={};if(d)return p.forEach((function(n){var a=h(e.name,n.type),p=m(e.name,n.type,"generic"),d=y(e.name,n.type),l=d?n.fields.filter((function(e){return e.hideField})):n.fields;S(e.name,n.type)&&(s=[]),s.push({component:"auth-select",name:"auth_select",label:n.name,authName:n.type,validate:[{type:o.REQUIRED}],disableAuthType:c}),s.push({component:i.SUB_FORM,name:"".concat(n.type,"-subform"),className:"pf-u-pl-md",fields:[].concat(r(A(e.name,n.type)),r(b(v(l,a),e.name,n.type))),condition:{when:"auth_select",is:n.type},hideField:d}),f[n.type]=u(e.name,n.type).length>0?"".concat(e.name,"-").concat(n.type,"-generic-additional-step"):0!==t.length||p?"summary":"".concat(e.name,"-endpoint")})),{name:e.name,title:n.createElement(a,{id:"wizard.credentials",defaultMessage:"Credentials"}),fields:s,nextStep:{when:"auth_select",stepMapper:f}};var j=p[0],_="".concat(e.name,"-").concat(j.type,"-generic-additional-step"),E=m(e.name,j.type,"generic"),F=u(e.name,j.type).length>0?_:0!==t.length||E?"summary":"".concat(e.name,"-endpoint"),O=h(e.name,j.type),w=l(e.name,j.type),K={};if(S(e.name,j.type)&&(s=[]),w){var M=u(e.name,j.type).find((function(e){return!e.name})),P=g(j.fields,_);K=_objectSpread({},M,{fields:[].concat(r(s),r(b([].concat(r(M.fields),r(P)),e.name,j.type)))})}return _objectSpread({name:e.name,title:n.createElement(a,{id:"wizard.credentials",defaultMessage:"Credentials"}),fields:[].concat(r(s),r(A(e.name,j.type)),r(b(v(j.fields,O),e.name,j.type))),nextStep:F},K)},w=function createSpecificAuthTypeSelection(e,t,c,p){var d=e.schema.authentication,j=t.supported_authentication_types[e.name],_=j.length>1,E=r(c),F={};if(_)return d.filter((function(e){var t=e.type;return j.includes(t)})).forEach((function(n){var a=s(e.name,n.type,t.name)?t.name:"generic";S(e.name,n.type,a)&&(E=[]);var d,l=m(e.name,n.type,a),g=f(e.name,n.type,a);d=u(e.name,n.type,t.name).length>0?"".concat(e.name,"-").concat(n.type,"-").concat(t.name,"-additional-step"):0!==c.length||l||g?"summary":"".concat(e.name,"-endpoint");var j=h(e.name,n.type,a),_=y(e.name,n.type,a),O=_?n.fields.filter((function(e){return e.hideField})):n.fields;E.push({component:"auth-select",name:"auth_select",label:n.name,authName:n.type,validate:[{type:o.REQUIRED}],supportedAuthTypes:t.supported_authentication_types[e.name],disableAuthType:p}),E.push({component:i.SUB_FORM,name:"".concat(n.type,"-subform"),className:"pf-u-pl-md",fields:[].concat(r(A(e.name,n.type,a)),r(b(v(O,j),e.name,n.type,a))),condition:{when:"auth_select",is:n.type},hideField:_}),F[n.type]=d})),{name:"".concat(e.name,"-").concat(t.id),title:n.createElement(a,{id:"wizard.chooseAuthType",defaultMessage:"Choose authentication type"}),fields:E,nextStep:{when:"auth_select",stepMapper:F}};var O,w=d.find((function(e){var t=e.type;return j.includes(t)})),K=s(e.name,w.type,t.name)?t.name:"generic",M="".concat(e.name,"-").concat(w.type,"-").concat(t.name,"-additional-step"),P=m(e.name,w.type,K),x=f(e.name,w.type,K);S(e.name,w.type,K)&&(E=[]),O=u(e.name,w.type,K).length>0?M:0!==c.length||P?"summary":"".concat(e.name,"-endpoint");var k=h(e.name,w.type,K),T={};if(l(e.name,w.type,K)){var C=u(e.name,w.type,K).find((function(e){return!e.name})),z=g(w.fields,M);O=C.nextStep?C.nextStep:0!==c.length||P||x?"summary":"".concat(e.name,"-endpoint"),T=_objectSpread({},C,{fields:[].concat(r(E),r(b([].concat(r(C.fields),r(z)),e.name,w.type,K)))})}return _objectSpread({name:"".concat(e.name,"-").concat(t.id),title:n.createElement(a,{id:"wizard.credentials",defaultMessage:"Credentials"}),fields:[].concat(r(E),r(A(e.name,w.type,K)),r(b(v(w.fields,k),e.name,w.type,K))),nextStep:O},T)},K=function schemaBuilder(e,t,n){var a=[];return e.forEach((function(e){var i=e.schema.endpoint.hidden?e.schema.endpoint.fields:[],o=0===i.length;a.push(O(e,i,n)),t.forEach((function(t){t.supported_source_types.includes(e.name)&&a.push(w(e,t,i,n))})),e.schema.authentication.forEach((function(n){var i=u(e.name,n.type);i.length>0&&a.push.apply(a,r(F(i,e.name,n.type,o,n.fields))),t.forEach((function(t){var i=u(e.name,n.type,t.name);i.length>0&&a.push.apply(a,r(F(i,e.name,n.type,o,n.fields,t.name)))}))})),o&&a.push(E(e.schema.endpoint,e.name))})),a},M=Object.freeze({__proto__:null,acronymMapper:d,hardcodedSchema:s,getAdditionalSteps:u,shouldSkipSelection:l,shouldSkipEndpoint:m,hasCustomSteps:f,getAdditionalStepKeys:h,getOnlyHiddenFields:y,getAdditionalStepFields:g,shouldUseAppAuth:S,getNoStepsFields:v,injectAuthFieldsInfo:b,injectEndpointFieldsInfo:j,getAdditionalAuthFields:A,getAdditionalEndpointFields:_,createEndpointStep:E,createAdditionalSteps:F,createGenericAuthTypeSelection:O,createSpecificAuthTypeSelection:w,schemaBuilder:K});export{d as a,m as b,f as c,h as d,y as e,g as f,u as g,s as h,S as i,v as j,b as k,j as l,A as m,_ as n,E as o,F as p,O as q,w as r,l as s,K as t,M as u};

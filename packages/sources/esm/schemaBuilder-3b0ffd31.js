import{_ as e}from"./objectWithoutProperties-be1375b5.js";import{_ as t}from"./defineProperty-523aa47c.js";import n from"react";import{FormattedMessage as a}from"react-intl";import i from"@data-driven-forms/react-form-renderer/dist/cjs/component-types";import o from"@data-driven-forms/react-form-renderer/dist/cjs/validator-types";import{_ as r}from"./toConsumableArray-174a803a.js";import c from"lodash/get";import{h as p}from"./hardcodedSchemas-26402f04.js";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _objectSpread(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(a),!0).forEach((function(n){t(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=function acronymMapper(e){return{"Amazon Web Services":"AWS"}[e]||e},s=function hardcodedSchema(e,t,n){return c(p,[e,"authentication",t,n],void 0)},l=function getAdditionalSteps(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"additionalSteps"],[])},u=function shouldSkipSelection(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"skipSelection"],!1)},m=function shouldSkipEndpoint(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"skipEndpoint"],!1)},f=function hasCustomSteps(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"customSteps"],!1)},h=function getAdditionalStepKeys(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"includeStepKeyFields"],[])},y=function getOnlyHiddenFields(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"onlyHiddenFields"],!1)},g=function getAdditionalStepFields(t,n){return t.filter((function(e){return e.stepKey===n})).map((function(t){t.stepKey;return e(t,["stepKey"])}))},S=function getNoStepsFields(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return!e.stepKey||t.includes(e.stepKey)}))},v=function injectAuthFieldsInfo(e,t,n,a){return e.map((function(e){var i=c(p,[t,"authentication",n,a]),o=i?c(i,e.name):c(p,[t,"authentication",n,"generic",e.name]),r=o?_objectSpread({},e,{},o):e;return"authentication.password"===r.name&&(r.component="authentication"),r}))},b=function injectEndpointFieldsInfo(e,t){return e.map((function(e){var n=c(p,[t,"endpoint",e.name]);return n?_objectSpread({},e,{},n):e}))},j=function getAdditionalAuthFields(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic";return c(p,[e,"authentication",t,n,"additionalFields"],[])},_=function getAdditionalEndpointFields(e){return c(p,[e,"endpoint","additionalFields"],[])},A=function createEndpointStep(e,t){return _objectSpread({},e,{fields:[].concat(r(_(t)),r(b(e.fields,t))),name:"".concat(t,"-endpoint"),nextStep:"summary"})},E=function createAdditionalSteps(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"generic";return e.map((function(e){var c=e.name||"".concat(t,"-").concat(n,"-").concat(o,"-additional-step"),p=m(t,n,o),d=f(t,n,o);return _objectSpread({name:c,nextStep:!a||p||d?"summary":"".concat(t,"-endpoint")},e,{fields:[].concat(r(v(e.fields,t,n,o)),r(v(g(i,c),t,n,o)))})}))},F=function createGenericAuthTypeSelection(e,t,c){var p=e.schema.authentication,s=p.length>1,f=r(t),b={};if(s)return p.forEach((function(n){var a=h(e.name,n.type),p=m(e.name,n.type,"generic"),d=y(e.name,n.type),s=d?n.fields.filter((function(e){return e.hideField})):n.fields;f.push({component:"auth-select",name:"auth_select",label:n.name,authName:n.type,validate:[{type:o.REQUIRED}],disableAuthType:c}),f.push({component:i.SUB_FORM,name:"".concat(n.type,"-subform"),className:"pf-u-pl-md",fields:[].concat(r(j(e.name,n.type)),r(v(S(s,a),e.name,n.type))),condition:{when:"auth_select",is:n.type},hideField:d}),b[n.type]=l(e.name,n.type).length>0?"".concat(e.name,"-").concat(n.type,"-generic-additional-step"):0!==t.length||p?"summary":"".concat(e.name,"-endpoint")})),{name:e.name,title:n.createElement(a,{id:"wizard.configureCredentials",defaultMessage:"Configure {title} credentials",values:{title:d(e.product_name)}}),fields:f,nextStep:{when:"auth_select",stepMapper:b}};var _=p[0],A="".concat(e.name,"-").concat(_.type,"-generic-additional-step"),E=m(e.name,_.type,"generic"),F=l(e.name,_.type).length>0?A:0!==t.length||E?"summary":"".concat(e.name,"-endpoint"),O=h(e.name,_.type),w={};if(u(e.name,_.type)){var K=l(e.name,_.type).find((function(e){return!e.name})),M=g(_.fields,A);w=_objectSpread({},K,{fields:[].concat(r(f),r(v([].concat(r(K.fields),r(M)),e.name,_.type)))})}return _objectSpread({name:e.name,title:n.createElement(a,{id:"wizard.configureTypeAuthcredentials",defaultMessage:"Configure {title} - {name} credentials",values:{title:d(e.product_name),name:_.name}}),fields:[].concat(r(f),r(j(e.name,_.type)),r(v(S(_.fields,O),e.name,_.type))),nextStep:F},w)},O=function createSpecificAuthTypeSelection(e,t,c,p){var d=e.schema.authentication,b=t.supported_authentication_types[e.name],_=b.length>1,A=r(c),E={};if(_)return d.filter((function(e){var t=e.type;return b.includes(t)})).forEach((function(n){var a,d=s(e.name,n.type,t.name)?t.name:"generic",u=m(e.name,n.type,d),g=f(e.name,n.type,d);a=l(e.name,n.type,t.name).length>0?"".concat(e.name,"-").concat(n.type,"-").concat(t.name,"-additional-step"):0!==c.length||u||g?"summary":"".concat(e.name,"-endpoint");var b=h(e.name,n.type,d),_=y(e.name,n.type,d),F=_?n.fields.filter((function(e){return e.hideField})):n.fields;A.push({component:"auth-select",name:"auth_select",label:n.name,authName:n.type,validate:[{type:o.REQUIRED}],supportedAuthTypes:t.supported_authentication_types[e.name],disableAuthType:p}),A.push({component:i.SUB_FORM,name:"".concat(n.type,"-subform"),className:"pf-u-pl-md",fields:[].concat(r(j(e.name,n.type,d)),r(v(S(F,b),e.name,n.type,d))),condition:{when:"auth_select",is:n.type},hideField:_}),E[n.type]=a})),{name:"".concat(e.name,"-").concat(t.id),title:n.createElement(a,{id:"wizard.chooseAuthType",defaultMessage:"Choose authentication type"}),fields:A,nextStep:{when:"auth_select",stepMapper:E}};var F,O=d.find((function(e){var t=e.type;return b.includes(t)})),w=s(e.name,O.type,t.name)?t.name:"generic",K="".concat(e.name,"-").concat(O.type,"-").concat(t.name,"-additional-step"),M=m(e.name,O.type,w),P=f(e.name,O.type,w);F=l(e.name,O.type,w).length>0?K:0!==c.length||M?"summary":"".concat(e.name,"-endpoint");var x=h(e.name,O.type,w),C={};if(u(e.name,O.type,w)){var T=l(e.name,O.type,w).find((function(e){return!e.name})),k=g(O.fields,K);F=T.nextStep?T.nextStep:0!==c.length||M||P?"summary":"".concat(e.name,"-endpoint"),C=_objectSpread({},T,{fields:[].concat(r(A),r(v([].concat(r(T.fields),r(k)),e.name,O.type,w)))})}return _objectSpread({name:"".concat(e.name,"-").concat(t.id),title:n.createElement(a,{id:"wizard.configureCredentials",defaultMessage:"Configure {title} credentials",title:{title:O.name}}),fields:[].concat(r(A),r(j(e.name,O.type,w)),r(v(S(O.fields,x),e.name,O.type,w))),nextStep:F},C)},w=function schemaBuilder(e,t,n){var a=[];return e.forEach((function(e){var i=e.schema.endpoint.hidden?e.schema.endpoint.fields:[],o=0===i.length;a.push(F(e,i,n)),t.forEach((function(t){t.supported_source_types.includes(e.name)&&a.push(O(e,t,i,n))})),e.schema.authentication.forEach((function(n){var i=l(e.name,n.type);i.length>0&&a.push.apply(a,r(E(i,e.name,n.type,o,n.fields))),t.forEach((function(t){var i=l(e.name,n.type,t.name);i.length>0&&a.push.apply(a,r(E(i,e.name,n.type,o,n.fields,t.name)))}))})),o&&a.push(A(e.schema.endpoint,e.name))})),a},K=Object.freeze({__proto__:null,acronymMapper:d,hardcodedSchema:s,getAdditionalSteps:l,shouldSkipSelection:u,shouldSkipEndpoint:m,hasCustomSteps:f,getAdditionalStepKeys:h,getOnlyHiddenFields:y,getAdditionalStepFields:g,getNoStepsFields:S,injectAuthFieldsInfo:v,injectEndpointFieldsInfo:b,getAdditionalAuthFields:j,getAdditionalEndpointFields:_,createEndpointStep:A,createAdditionalSteps:E,createGenericAuthTypeSelection:F,createSpecificAuthTypeSelection:O,schemaBuilder:w});export{d as a,m as b,f as c,h as d,y as e,g as f,l as g,s as h,S as i,v as j,b as k,j as l,_ as m,A as n,E as o,F as p,O as q,w as r,u as s,K as t};

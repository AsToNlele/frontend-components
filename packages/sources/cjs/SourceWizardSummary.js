"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0}),require("./objectWithoutProperties-9e2b4e81.js"),require("./slicedToArray-359307e9.js"),require("./defineProperty-cf06dcaa.js");var React=require("react"),React__default=_interopDefault(React),Button_js=require("@patternfly/react-core/dist/js/components/Button/Button.js"),PropTypes=_interopDefault(require("prop-types")),reactIntl=require("react-intl");require("@data-driven-forms/react-form-renderer/dist/cjs/component-types"),require("@data-driven-forms/react-form-renderer/dist/cjs/validator-types");var toConsumableArray=require("./toConsumableArray-fe9ed082.js"),TextContent_js=require("@patternfly/react-core/dist/js/components/Text/TextContent.js"),TextListItem_js=require("@patternfly/react-core/dist/js/components/Text/TextListItem.js"),TextList_js=require("@patternfly/react-core/dist/js/components/Text/TextList.js"),Alert_js=require("@patternfly/react-core/dist/js/components/Alert/Alert.js"),get=_interopDefault(require("lodash/get"));require("@patternfly/react-core/dist/js/components/Form/FormHelperText.js"),require("@patternfly/react-icons/dist/js/icons/question-circle-icon");var Popover_js=require("@patternfly/react-core/dist/js/components/Popover/Popover.js");require("@patternfly/react-core/dist/js/components/Text/Text.js");var hardcodedSchemas=require("./hardcodedSchemas-11027244.js");require("@patternfly/react-core/dist/js/components/ClipboardCopy/ClipboardCopy.js");var useFormApi=_interopDefault(require("@data-driven-forms/react-form-renderer/dist/cjs/use-form-api"));require("@redhat-cloud-services/frontend-components-utilities/files/cjs/interceptors");var constants=require("./constants.js");require("./index-1dfedd03.js");var schemaBuilder=require("./schemaBuilder-3e86f68c.js"),ValuePopover=function ValuePopover(e){var t=e.label,a=e.value,r=reactIntl.useIntl();return React__default.createElement(Popover_js.Popover,{headerContent:t,bodyContent:a,position:"top",maxWidth:"80%"},React__default.createElement(Button_js.Button,{variant:"link",isInline:!0,className:"ins-c-sources__wizard--summary-buttonss"},r.formatMessage({id:"wizard.showMore",defaultMessage:"Show more"})))};ValuePopover.propTypes={label:PropTypes.node,value:PropTypes.node};var createItem=function createItem(e,t,a){var r=get(t,e.name);if((!e.stepKey||a.includes(e.stepKey))&&!(e.condition&&get(t,e.condition.when)!==e.condition.is||e.hideField))return r&&"password"===e.type&&(r="●●●●●●●●●●●●"),"boolean"==typeof r&&(r=r?React__default.createElement(reactIntl.FormattedMessage,{id:"wizard.yes",defaultMessage:"Yes"}):React__default.createElement(reactIntl.FormattedMessage,{id:"wizard.no",defaultMessage:"No"})),!r&&"authentication.password"===e.name&&get(t,"authentication.id")&&(r="●●●●●●●●●●●●"),{label:e["aria-label"]||e.label,value:r||"-"}},getAllFieldsValues=function getAllFieldsValues(e,t,a){return e.map((function(e){return createItem(e,t,a)})).filter(Boolean)},getStepKeys=function getStepKeys(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic",r=arguments.length>3?arguments[3]:void 0;return[].concat(toConsumableArray._toConsumableArray(get(hardcodedSchemas.hardcodedSchemas,[e,"authentication",t,a,"includeStepKeyFields"],[])),toConsumableArray._toConsumableArray(get(hardcodedSchemas.hardcodedSchemas,[e,"authentication",t,a,"additionalSteps"],[]).map((function(e){return e.name}))),["".concat(e,"-").concat(t,"-").concat(a,"-additional-step"),"".concat(e,"-").concat(t,"-additional-step"),r?"".concat(e,"-").concat(r):void 0]).filter(Boolean)},SourceWizardSummary=function SourceWizardSummary(e){var t,a=e.sourceTypes,r=e.applicationTypes,s=e.showApp,n=e.showAuthType,i=useFormApi(),o=reactIntl.useIntl(),c=i.getState().values,l=a.find((function(e){return e.name===c.source_type||e.id===c.source.source_type_id})),u=c.authentication&&c.authentication.authtype?c.authentication.authtype:c.auth_select,d=[];u&&(t=l.schema.authentication.find((function(e){return e.type===u})),d=t&&t.fields?t.fields:[]);var m=c.application?r.find((function(e){return e.id===c.application.application_type_id})):void 0,p=m||{},f=p.display_name,_=void 0===f?o.formatMessage({id:"wizard.notSelected",defaultMessage:"Not selected"}):f,y=p.name,T=p.id,h=schemaBuilder.shouldSkipEndpoint(l.name,u,y),j=l.schema.endpoint.fields;h&&(j=[],d=d.filter((function(e){return!e.name.includes("authentication.")})));var x=getStepKeys(l.name,u,y,T),g=schemaBuilder.getAdditionalSteps(l.name,u,y),I=get(hardcodedSchemas.hardcodedSchemas,[l.name,"authentication",u,y,"customSteps"],!1);g.length>0&&(d=g.map((function(e){return[].concat(toConsumableArray._toConsumableArray(e.fields),toConsumableArray._toConsumableArray(d.filter((function(t){var a=t.stepKey;return a&&e.name===a}))))})).flatMap((function(e){return e})).filter((function(e){var t=e.name;return d.find((function(e){return e.name===t}))||I&&j.find((function(e){return e.name===t}))}))),I&&(j=[]),d=schemaBuilder.injectAuthFieldsInfo(d,l.name,u,y||"generic"),j=schemaBuilder.injectEndpointFieldsInfo(j,l.name);var L=[].concat(toConsumableArray._toConsumableArray(d),toConsumableArray._toConsumableArray(j)),v=getAllFieldsValues(L,c,x).map((function(e){var t=e.label,a=e.value;return(React__default.createElement(React__default.Fragment,{key:"".concat(t,"--").concat(a)},React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dt},t),React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dd},a.toString().length>150?React__default.createElement(ValuePopover,{label:t,value:a}):a)))}));return React__default.createElement(React__default.Fragment,null,React__default.createElement(TextContent_js.TextContent,null,React__default.createElement(TextList_js.TextList,{component:TextList_js.TextListVariants.dl},React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dt},o.formatMessage({id:"wizard.name",defaultMessage:"Name"})),React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dd},c.source.name),s&&React__default.createElement(React__default.Fragment,null,React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dt},o.formatMessage({id:"wizard.application",defaultMessage:"Application"})),React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dd},_)),React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dt},o.formatMessage({id:"wizard.sourceType",defaultMessage:"Source type"})),React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dd},l.product_name),!h&&t&&n&&React__default.createElement(React__default.Fragment,null,React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dt},o.formatMessage({id:"wizard.authenticationType",defaultMessage:"Authentication type"})),React__default.createElement(TextListItem_js.TextListItem,{component:TextListItem_js.TextListItemVariants.dd},t.name)),v)),y===constants.COST_MANAGEMENT_APP_NAME&&React__default.createElement(Alert_js.Alert,{variant:"info",isInline:!0,title:o.formatMessage({id:"cost.rbacWarningTitle",defaultMessage:"Manage permissions in User Access"})},o.formatMessage({id:"cost.rbacWarningDescription",defaultMessage:"Make sure to manage permissions for this source in custom roles that contain permissions for Cost Management."})))};SourceWizardSummary.propTypes={sourceTypes:PropTypes.arrayOf(PropTypes.shape({id:PropTypes.string.isRequired,name:PropTypes.string.isRequired,product_name:PropTypes.string.isRequired,schema:PropTypes.shape({authentication:PropTypes.array,endpoint:PropTypes.object})})).isRequired,applicationTypes:PropTypes.arrayOf(PropTypes.shape({id:PropTypes.string.isRequired,name:PropTypes.string.isRequired,display_name:PropTypes.string.isRequired})).isRequired,showApp:PropTypes.bool,showAuthType:PropTypes.bool},SourceWizardSummary.defaultProps={showApp:!0,showAuthType:!0},exports.createItem=createItem,exports.default=SourceWizardSummary,exports.getAllFieldsValues=getAllFieldsValues,exports.getStepKeys=getStepKeys;
